\begin{code}%
\>[0]\AgdaKeyword{module}\AgdaSpace{}%
\AgdaModule{Snippets}\AgdaSpace{}%
\AgdaKeyword{where}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
\>[0][@{}l@{\AgdaIndent{0}}]%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Base}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{Equality}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{EquationalReasoning}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{numbers.Integers}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{equivalence.Equivalence}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{equivalence.EquivalenceComposition}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{equivalence.Quasiinverses}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{logic.Quotients}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{algebra.Groups}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{algebra.IntegerAction}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{topology.Circle}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{topology.FundamentalGroup}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{equality.Univalence}\AgdaSpace{}%
\AgdaKeyword{renaming}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{ua}\AgdaSpace{}%
\AgdaSymbol{to}\AgdaSpace{}%
\AgdaFunction{UnivalenceAxiom}\AgdaSymbol{)}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{equality.FunctionExtensionality}\<%
\\
%
\>[2]\AgdaKeyword{open}\AgdaSpace{}%
\AgdaKeyword{import}\AgdaSpace{}%
\AgdaModule{topology.FundGroupCircle}\<%
\\
\>[2][@{}l@{\AgdaIndent{0}}]%
\>[4]\AgdaKeyword{hiding}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{loops}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{code}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{equiv{-}family}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{fundamental{-}group{-}of{-}the{-}circle}\AgdaSymbol{;}\AgdaSpace{}%
\AgdaFunction{preserves{-}composition}\AgdaSymbol{)}\<%
\end{code}
%<*circle>
\begin{code}%
%
\>[2]\AgdaComment{{-}{-} Winds a loop n times on the circle.}\<%
\\
%
\>[2]\AgdaFunction{loops}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaDatatype{ℤ}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Ω}\AgdaSpace{}%
\AgdaFunction{S¹}\AgdaSpace{}%
\AgdaFunction{base}\<%
\\
%
\>[2]\AgdaFunction{loops}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{z{-}act}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Ω{-}st}\AgdaSpace{}%
\AgdaFunction{S¹}\AgdaSpace{}%
\AgdaFunction{base}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaPostulate{loop}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{{-}{-} Uses univalence to unwind a path over the integers.}\<%
\\
%
\>[2]\AgdaFunction{code}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{S¹}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{Type0}\<%
\\
%
\>[2]\AgdaFunction{code}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{S¹{-}ind}\AgdaSpace{}%
\AgdaFunction{Type0}\AgdaSpace{}%
\AgdaDatatype{ℤ}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{UnivalenceAxiom}\AgdaSpace{}%
\AgdaFunction{zequiv{-}succ}\AgdaSymbol{)}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{{-}{-} Creates an equivalence between paths and encodings.}\<%
\\
%
\>[2]\AgdaFunction{equiv{-}family}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{S¹}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{base}\AgdaSpace{}%
\AgdaDatatype{==}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaFunction{≃}\AgdaSpace{}%
\AgdaFunction{code}\AgdaSpace{}%
\AgdaBound{x}\<%
\\
%
\>[2]\AgdaFunction{equiv{-}family}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{qinv{-}≃}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{encode}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{decode}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaInductiveConstructor{,}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{encode{-}decode}\AgdaSpace{}%
\AgdaBound{x}\AgdaSpace{}%
\AgdaInductiveConstructor{,}\AgdaSpace{}%
\AgdaFunction{decode{-}encode}\AgdaSpace{}%
\AgdaBound{x}\AgdaSymbol{))}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaComment{{-}{-} The fundamental group of the circle is the integers.  In this}\<%
\\
%
\>[2]\AgdaComment{{-}{-} proof, univalence is crucial. The next lemma will prove that the}\<%
\\
%
\>[2]\AgdaComment{{-}{-} equivalence in fact preserves the group structure.}\<%
\\
%
\>[2]\AgdaFunction{fundamental{-}group{-}of{-}the{-}circle}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaFunction{Ω}\AgdaSpace{}%
\AgdaFunction{S¹}\AgdaSpace{}%
\AgdaFunction{base}\AgdaSpace{}%
\AgdaFunction{≃}\AgdaSpace{}%
\AgdaDatatype{ℤ}\<%
\\
%
\>[2]\AgdaFunction{fundamental{-}group{-}of{-}the{-}circle}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{equiv{-}family}\AgdaSpace{}%
\AgdaFunction{base}\<%
\\
%
\\[\AgdaEmptyExtraSkip]%
%
\>[2]\AgdaFunction{preserves{-}composition}\AgdaSpace{}%
\AgdaSymbol{:}\AgdaSpace{}%
\AgdaSymbol{∀}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{→}\AgdaSpace{}%
\AgdaFunction{loops}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaBound{n}\AgdaSpace{}%
\AgdaFunction{+ᶻ}\AgdaSpace{}%
\AgdaBound{m}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaDatatype{==}\AgdaSpace{}%
\AgdaFunction{loops}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaFunction{·}\AgdaSpace{}%
\AgdaFunction{loops}\AgdaSpace{}%
\AgdaBound{m}\<%
\\
%
\>[2]\AgdaFunction{preserves{-}composition}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaSymbol{=}\AgdaSpace{}%
\AgdaFunction{z{-}act+}\AgdaSpace{}%
\AgdaSymbol{(}\AgdaFunction{Ω{-}st}\AgdaSpace{}%
\AgdaFunction{S¹}\AgdaSpace{}%
\AgdaFunction{base}\AgdaSymbol{)}\AgdaSpace{}%
\AgdaBound{n}\AgdaSpace{}%
\AgdaBound{m}\AgdaSpace{}%
\AgdaPostulate{loop}\<%
\end{code}
%</circle>
